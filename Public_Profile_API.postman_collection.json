{
	"info": {
		"_postman_id": "public-profile-api-2024",
		"name": "Public Profile Viewing API Collection",
		"description": "Complete API collection for public profile viewing endpoints - No authentication required for browsing profile cards",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "public-profile-api"
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"exec": [
					"// Auto-set base URL if not set",
					"if (!pm.variables.get('base_url')) {",
					"    pm.variables.set('base_url', 'http://localhost:8080');",
					"}"
				],
				"type": "text/javascript"
			}
		}
	],
	"item": [
		{
			"name": "Public Profile Browsing",
			"item": [
				{
					"name": "Browse Public Profiles",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Response has success message', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response.message).to.include('successfully');",
									"});",
									"",
									"pm.test('Response contains profile data', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response.data).to.have.property('content');",
									"    pm.expect(response.data).to.have.property('totalElements');",
									"    pm.expect(response.data).to.have.property('totalPages');",
									"    pm.expect(response.data).to.have.property('size');",
									"    pm.expect(response.data).to.have.property('number');",
									"});",
									"",
									"pm.test('Profile data structure is correct', function () {",
									"    const response = pm.response.json();",
									"    if (response.data.content && response.data.content.length > 0) {",
									"        const profile = response.data.content[0];",
									"        pm.expect(profile).to.have.property('completeProfileId');",
									"        pm.expect(profile).to.have.property('userId');",
									"        pm.expect(profile).to.have.property('completionPercentage');",
									"        pm.expect(profile).to.have.property('profileQuality');",
									"        pm.expect(profile).to.have.property('userProfile');",
									"        // Verify sensitive data is not exposed",
									"        pm.expect(profile.contactDetails).to.be.null;",
									"        pm.expect(profile.documents).to.be.null;",
									"    }",
									"});",
									"",
									"// Save first profile ID for other tests",
									"const response = pm.response.json();",
									"if (response.data.content && response.data.content.length > 0) {",
									"    pm.environment.set('sample_user_id', response.data.content[0].userId);",
									"    pm.environment.set('sample_complete_profile_id', response.data.content[0].completeProfileId);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/complete-profile/public/browse?page=0&size=20&sortBy=completenessScore&sortDir=DESC",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"complete-profile",
								"public",
								"browse"
							],
							"query": [
								{
									"key": "page",
									"value": "0",
									"description": "Page number (0-based)"
								},
								{
									"key": "size",
									"value": "20",
									"description": "Number of profiles per page (max 50)"
								},
								{
									"key": "sortBy",
									"value": "completenessScore",
									"description": "Sort field (completenessScore, updatedAt, completionPercentage)"
								},
								{
									"key": "sortDir",
									"value": "DESC",
									"description": "Sort direction (ASC or DESC)"
								}
							]
						},
						"description": "Browse paginated list of public profiles. No authentication required. Perfect for profile discovery and browsing."
					}
				},
				{
					"name": "Browse Profiles - Page 2",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Response contains pagination info', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response.data.number).to.eql(1); // Page 2 (0-based)",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/complete-profile/public/browse?page=1&size=10&sortBy=updatedAt&sortDir=DESC",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"complete-profile",
								"public",
								"browse"
							],
							"query": [
								{
									"key": "page",
									"value": "1",
									"description": "Page 2 (0-based)"
								},
								{
									"key": "size",
									"value": "10",
									"description": "10 profiles per page"
								},
								{
									"key": "sortBy",
									"value": "updatedAt",
									"description": "Sort by last updated"
								},
								{
									"key": "sortDir",
									"value": "DESC",
									"description": "Newest first"
								}
							]
						},
						"description": "Example of browsing second page with different sorting"
					}
				}
			],
			"description": "Endpoints for browsing public profiles without authentication"
		},
		{
			"name": "Individual Profile Access",
			"item": [
				{
					"name": "Get Profile by User ID",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Response has success message', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response.message).to.include('successfully');",
									"});",
									"",
									"pm.test('Profile data is complete', function () {",
									"    const response = pm.response.json();",
									"    const profile = response.data;",
									"    pm.expect(profile).to.have.property('completeProfileId');",
									"    pm.expect(profile).to.have.property('userId');",
									"    pm.expect(profile).to.have.property('completionPercentage');",
									"    pm.expect(profile).to.have.property('profileQuality');",
									"    pm.expect(profile).to.have.property('userProfile');",
									"});",
									"",
									"pm.test('Sensitive data is hidden', function () {",
									"    const response = pm.response.json();",
									"    const profile = response.data;",
									"    // Verify sensitive information is not exposed in public view",
									"    pm.expect(profile.contactDetails).to.be.null;",
									"    pm.expect(profile.documents).to.be.null;",
									"    if (profile.strengthMetrics) {",
									"        pm.expect(profile.strengthMetrics.contactInfoScore).to.be.null;",
									"        pm.expect(profile.strengthMetrics.documentScore).to.be.null;",
									"        pm.expect(profile.strengthMetrics.mobileVerified).to.be.null;",
									"        pm.expect(profile.strengthMetrics.emailVerified).to.be.null;",
									"    }",
									"});",
									"",
									"pm.test('User profile data is present', function () {",
									"    const response = pm.response.json();",
									"    const profile = response.data;",
									"    if (profile.userProfile) {",
									"        pm.expect(profile.userProfile).to.have.property('firstName');",
									"        pm.expect(profile.userProfile).to.have.property('age');",
									"        pm.expect(profile.userProfile).to.have.property('gender');",
									"    }",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/complete-profile/public/user/{{sample_user_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"complete-profile",
								"public",
								"user",
								"{{sample_user_id}}"
							]
						},
						"description": "Get public profile information by user ID. Uses sample_user_id from browse results or set manually."
					}
				},
				{
					"name": "Get Profile by User ID - Manual",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200 or 404', function () {",
									"    pm.expect(pm.response.code).to.be.oneOf([200, 404]);",
									"});",
									"",
									"if (pm.response.code === 200) {",
									"    pm.test('Profile data is valid', function () {",
									"        const response = pm.response.json();",
									"        pm.expect(response.data).to.have.property('userId');",
									"        pm.expect(response.data.userId).to.eql(10001);",
									"    });",
									"} else {",
									"    pm.test('Profile not found message', function () {",
									"        const response = pm.response.json();",
									"        pm.expect(response.message).to.include('not found');",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/complete-profile/public/user/10001",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"complete-profile",
								"public",
								"user",
								"10001"
							]
						},
						"description": "Get public profile by specific user ID (10001). Change the user ID as needed."
					}
				},
				{
					"name": "Get Profile by Complete Profile ID",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Profile data matches complete profile ID', function () {",
									"    const response = pm.response.json();",
									"    const profile = response.data;",
									"    pm.expect(profile).to.have.property('completeProfileId');",
									"});",
									"",
									"pm.test('Public safety checks', function () {",
									"    const response = pm.response.json();",
									"    const profile = response.data;",
									"    pm.expect(profile.contactDetails).to.be.null;",
									"    pm.expect(profile.documents).to.be.null;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/complete-profile/public/profile/{{sample_complete_profile_id}}",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"complete-profile",
								"public",
								"profile",
								"{{sample_complete_profile_id}}"
							]
						},
						"description": "Get public profile by complete profile ID. Alternative way to access profiles."
					}
				},
				{
					"name": "Get Profile by Complete Profile ID - Manual",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200 or 404', function () {",
									"    pm.expect(pm.response.code).to.be.oneOf([200, 404]);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/complete-profile/public/profile/1",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"complete-profile",
								"public",
								"profile",
								"1"
							]
						},
						"description": "Get public profile by specific complete profile ID (1). Change the ID as needed."
					}
				}
			],
			"description": "Endpoints for accessing individual profiles by ID"
		},
		{
			"name": "Error Handling Tests",
			"item": [
				{
					"name": "Non-existent User ID",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 404', function () {",
									"    pm.response.to.have.status(404);",
									"});",
									"",
									"pm.test('Error message is appropriate', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response.message).to.include('not found');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/complete-profile/public/user/999999",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"complete-profile",
								"public",
								"user",
								"999999"
							]
						},
						"description": "Test error handling for non-existent user ID"
					}
				},
				{
					"name": "Invalid Complete Profile ID",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 404', function () {",
									"    pm.response.to.have.status(404);",
									"});",
									"",
									"pm.test('Error response structure', function () {",
									"    const response = pm.response.json();",
									"    pm.expect(response).to.have.property('message');",
									"    pm.expect(response).to.have.property('success');",
									"    pm.expect(response.success).to.be.false;",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/complete-profile/public/profile/999999",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"complete-profile",
								"public",
								"profile",
								"999999"
							]
						},
						"description": "Test error handling for non-existent complete profile ID"
					}
				},
				{
					"name": "Invalid Browse Parameters",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 400 or 200', function () {",
									"    // Some invalid parameters might be handled gracefully",
									"    pm.expect(pm.response.code).to.be.oneOf([200, 400]);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/complete-profile/public/browse?page=-1&size=100&sortBy=invalidField",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"complete-profile",
								"public",
								"browse"
							],
							"query": [
								{
									"key": "page",
									"value": "-1",
									"description": "Invalid negative page"
								},
								{
									"key": "size",
									"value": "100",
									"description": "Size exceeds maximum (50)"
								},
								{
									"key": "sortBy",
									"value": "invalidField",
									"description": "Invalid sort field"
								}
							]
						},
						"description": "Test error handling for invalid browse parameters"
					}
				}
			],
			"description": "Tests for error handling and edge cases"
		},
		{
			"name": "Performance & Rate Limiting Tests",
			"item": [
				{
					"name": "Rate Limiting Test",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200 or 429', function () {",
									"    // Should be 200 for normal requests, 429 if rate limited",
									"    pm.expect(pm.response.code).to.be.oneOf([200, 429]);",
									"});",
									"",
									"if (pm.response.code === 429) {",
									"    pm.test('Rate limit message', function () {",
									"        const response = pm.response.json();",
									"        pm.expect(response.message).to.include('rate limit');",
									"    });",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/complete-profile/public/browse?page=0&size=5",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"complete-profile",
								"public",
								"browse"
							],
							"query": [
								{
									"key": "page",
									"value": "0"
								},
								{
									"key": "size",
									"value": "5"
								}
							]
						},
						"description": "Test rate limiting on public endpoints. Run multiple times quickly to test rate limiting."
					}
				},
				{
					"name": "Large Page Size Test",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Page size is limited to maximum', function () {",
									"    const response = pm.response.json();",
									"    // Size should be limited to 50 even if we request more",
									"    pm.expect(response.data.size).to.be.at.most(50);",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/v1/complete-profile/public/browse?page=0&size=50",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"complete-profile",
								"public",
								"browse"
							],
							"query": [
								{
									"key": "page",
									"value": "0"
								},
								{
									"key": "size",
									"value": "50",
									"description": "Maximum allowed page size"
								}
							]
						},
						"description": "Test maximum page size limit (50 profiles per page)"
					}
				}
			],
			"description": "Tests for performance and rate limiting behavior"
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8080",
			"type": "string"
		}
	]
}