server.port=8080

#datasource
##spring.datasource.url=jdbc:mysql://root:${MYSQL_ROOT_PASSWORD}:18887/railway?createDatabaseIfNotExist=true&useSSL=true
#MYSQL_PUBLIC_URL=jdbc:mysql://${RAILWAY_TCP_PROXY_DOMAIN}:${RAILWAY_TCP_PROXY_PORT}/${MYSQLDATABASE}?createDatabaseIfNotExist=true&useSSL=true
#spring.datasource.username=${MYSQLUSER}
#spring.datasource.password=${MYSQLPASSWORD}
#spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

spring.jpa.generate-ddl=true
# Disable SQL logging in production
spring.jpa.show-sql=false

# HikariCP Connection Pool Configuration (Optimized for Production)
# CRITICAL: Prevents connection exhaustion and timeouts
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.pool-name=MatrimonyHikariPool
spring.datasource.hikari.leak-detection-threshold=30000
spring.datasource.hikari.connection-test-query=SELECT 1
spring.datasource.hikari.validation-timeout=5000

# JPA/Hibernate Performance Settings
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.jdbc.batch_size=25
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true
spring.jpa.properties.hibernate.default_batch_fetch_size=16

spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect

spring.jpa.hibernate.ddl-auto=update

spring.main.allow-circular-references=true

spring.mail.username=""
spring.mail.password=""
spring.mail.host=smtp.gmail.com
spring.mail.port=465
spring.mail.properties.mail.smtp.ssl.enable=true
spring.mail.properties.mail.smtp.auth=true

# Swagger properties
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.api-docs.path=/v3/api-docs

# Rate limiting settings
app.rate-limiting.enabled=true
app.rate-limiting.limit-for-period=100
app.rate-limiting.refresh-period=60
app.rate-limiting.timeout-duration=300

spring.task.scheduling.time-zone=Asia/Kolkata

# Password reset URL
app.url.password-reset=http://localhost:3000/reset-password

# CORS configuration
app.cors.allowed-origins=http://localhost:5173,https://matrimony-v1.netlify.app,https://matrimon1.netlify.app

# JWT Configuration (Production)
# SECURITY: Device fingerprinting enabled for token theft protection
# IMPORTANT: Fingerprint uses ONLY browser characteristics (User-Agent, Accept-Language, Accept-Encoding)
# Does NOT use IP address - safe for mobile users, WiFi switching, VPN users
# Users can still use multiple devices - each device needs separate login (normal security behavior)
jwt.secret=${JWT_SECRET}
jwt.device-fingerprinting-enabled=true
jwt.not-before=0
jwt.allowed-clock-skew-seconds=5
jwt.expiration=7200
jwt.enforce-single-session=true
jwt.max-active-sessions=3

# Encryption settings (Production)
# CRITICAL: Replace these with environment variables before deploying!
app.encryption.secret-key= ${SECRET_KEY}
app.encryption.legacy-keys=${LEGACY_KEY}
app.encryption.debug=false

# SSL configuration
app.ssl.enabled=false
server.ssl.enabled=false

# Exam Result Scheduler Configuration
app.scheduler.exam-results=0 */5 * * * *

# Root level - ERRORS ONLY
logging.level.root=ERROR

# Spring Framework - ERRORS ONLY
logging.level.org.springframework=ERROR
logging.level.org.springframework.web=ERROR
logging.level.org.springframework.security=ERROR
logging.level.org.springframework.boot=ERROR

# Hibernate/JPA - COMPLETELY SILENT
logging.level.org.hibernate=ERROR
logging.level.org.hibernate.SQL=OFF
logging.level.org.hibernate.type.descriptor.sql=OFF
logging.level.org.hibernate.orm.jdbc.bind=OFF

# HikariCP - ERRORS ONLY (no connection acquisition logs)
logging.level.com.zaxxer.hikari=ERROR
logging.level.com.zaxxer.hikari.HikariConfig=ERROR
logging.level.com.zaxxer.hikari.pool=ERROR

# Application logging - WARN level (only problems)
logging.level.com.spring.jwt=WARN

# Security filters - ERRORS ONLY (no per-request logging)
logging.level.com.spring.jwt.config.filter=ERROR
logging.level.com.spring.jwt.jwt=ERROR

# Exception handlers - WARN (log errors but not stack traces)
logging.level.com.spring.jwt.exception=WARN

# Disable noisy libraries COMPLETELY
logging.level.io.swagger=ERROR
logging.level.springfox=ERROR
logging.level.org.apache=ERROR
logging.level.io.netty=ERROR
logging.level.org.flywaydb=ERROR

# Log pattern - MINIMAL (no thread names, short logger names)
logging.pattern.console=%d{HH:mm:ss} %-5level %logger{20} - %msg%n
